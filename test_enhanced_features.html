<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Universal Extractor Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .test-section h3 {
            color: #333;
            margin-top: 0;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }

        button:hover {
            background: #0056b3;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .result {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            white-space: pre-wrap;
            font-family: monospace;
        }

        .success {
            border-left: 4px solid #28a745;
        }

        .error {
            border-left: 4px solid #dc3545;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .feature-list {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
        }

        .feature-list ul {
            margin: 10px 0;
        }

        .feature-list li {
            margin: 5px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üöÄ Enhanced Universal Extractor Test</h1>
        <p>This page demonstrates the enhanced features of your Legal AI system without changing the existing pipeline.
        </p>

        <div class="feature-list">
            <h3>üéØ Enhanced Features Available:</h3>
            <ul>
                <li><strong>13 Document Types</strong> (vs current limited set)</li>
                <li><strong>Law Clinic Brochures</strong> ‚Üí academic_program_or_clinic_brochure</li>
                <li><strong>Grant Notices/RFAs</strong> ‚Üí grant_notice_or_rfa</li>
                <li><strong>Meeting Minutes</strong> ‚Üí meeting_minutes</li>
                <li><strong>SOWs/Contracts</strong> ‚Üí procurement_sow_or_contract</li>
                <li><strong>Audit Reports</strong> ‚Üí audit_or_investigation_report</li>
                <li><strong>Federal Reports</strong> ‚Üí federal_report_to_congress</li>
                <li><strong>Proposals/White Papers</strong> ‚Üí proposal_or_whitepaper</li>
                <li><strong>Structured Extraction</strong> with evidence and page numbers</li>
                <li><strong>Enhanced Classification</strong> with confidence scoring</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>üìã Test 1: Enhanced Document Type Classification</h3>
            <p>Compare existing vs enhanced document classification:</p>
            <button onclick="testEnhancedExtractor()" id="btn1">Test Enhanced Extractor</button>
            <div id="result1" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üîç Test 2: Enhanced Analysis Comparison</h3>
            <p>Compare standard vs enhanced analysis results:</p>
            <button onclick="testEnhancedAnalysis()" id="btn2">Test Enhanced Analysis</button>
            <div id="result2" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>üìä Test 3: Sample Document Analysis</h3>
            <p>Test with a sample legal document to see enhanced features:</p>
            <button onclick="testSampleDocument()" id="btn3">Test Sample Document</button>
            <div id="result3" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000';

        async function testEnhancedExtractor() {
            const btn = document.getElementById('btn1');
            const result = document.getElementById('result1');

            btn.disabled = true;
            btn.textContent = 'Testing...';
            result.style.display = 'none';

            try {
                const testDoc = {
                    text: `U.S. DEPARTMENT OF STATE
BUREAU OF DEMOCRACY, HUMAN RIGHTS, AND LABOR
COUNTRY REPORT ON HUMAN RIGHTS PRACTICES FOR 2023

JAPAN

Executive Summary

Japan is a parliamentary democracy with a constitutional monarchy. The country has a population of approximately 125 million people. The government generally respects the human rights of its citizens, though there are some concerns in certain areas.

Key Findings:
- Freedom of expression and press are generally respected
- Some concerns regarding reproductive health services access
- Crimes targeting minority groups and LGBTQ+ individuals
- Prison conditions generally meet international standards
- Government took steps to address human rights abuses

This report covers the period from January 1 to December 31, 2023.`,
                    filename: 'test-japan-human-rights-2023.pdf'
                };

                const response = await fetch(`${API_BASE}/api/test/enhanced-extractor`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testDoc)
                });

                if (response.ok) {
                    const data = await response.json();
                    result.innerHTML = `‚úÖ Enhanced Extractor Test Results:

üìä Classification Comparison:
   Existing: ${data.comparison.existing_classification}
   Enhanced: ${data.comparison.enhanced_classification}

üéØ Enhanced Features:
   Document Type: ${data.enhanced_features.document_type}
   Confidence: ${Math.round(data.enhanced_features.confidence * 100)}%
   Evidence Count: ${data.enhanced_features.evidence_count}
   Available Sections: ${data.enhanced_features.sections_available.join(', ')}

üìù Full Enhanced Result:
${JSON.stringify(data.enhanced_full_result, null, 2)}`;
                    result.className = 'result success';
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                result.innerHTML = `‚ùå Test Failed: ${error.message}`;
                result.className = 'result error';
            } finally {
                btn.disabled = false;
                btn.textContent = 'Test Enhanced Extractor';
                result.style.display = 'block';
            }
        }

        async function testEnhancedAnalysis() {
            const btn = document.getElementById('btn2');
            const result = document.getElementById('result2');

            btn.disabled = true;
            btn.textContent = 'Testing...';
            result.style.display = 'none';

            try {
                const testDoc = {
                    text: `GRANT NOTICE OF FUNDING OPPORTUNITY
Department of Health and Human Services
Administration for Children and Families

Program: Refugee Resettlement Services
Funding Ceiling: $2,500,000
Application Deadline: March 15, 2024

Eligibility: Non-profit organizations serving refugee populations
Deliverables: Case management, language services, employment assistance

This funding opportunity supports refugee resettlement programs across the United States.`,
                    filename: 'test-grant-notice-2024.pdf'
                };

                const response = await fetch(`${API_BASE}/api/test/enhanced-analysis`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testDoc)
                });

                if (response.ok) {
                    const data = await response.json();
                    result.innerHTML = `‚úÖ Enhanced Analysis Test Results:

üìä Analysis Comparison:

   Standard Analysis:
     Document Type: ${data.comparison.standard_analysis.document_type}
     Verdict: ${data.comparison.standard_analysis.verdict}
     Confidence: ${Math.round(data.comparison.standard_analysis.confidence * 100)}%

   Enhanced Analysis:
     Document Type: ${data.comparison.enhanced_analysis.document_type}
     Verdict: ${data.comparison.enhanced_analysis.verdict}
     Confidence: ${Math.round(data.comparison.enhanced_analysis.confidence * 100)}%

üéØ Enhanced Features Demonstrated:
   Expanded Document Types: ${data.enhanced_features_demonstrated.expanded_document_types}
   Structured Extraction: ${data.enhanced_features_demonstrated.structured_extraction}
   Evidence-Based Analysis: ${data.enhanced_features_demonstrated.evidence_based_analysis}`;
                    result.className = 'result success';
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                result.innerHTML = `‚ùå Test Failed: ${error.message}`;
                result.className = 'result error';
            } finally {
                btn.disabled = false;
                btn.textContent = 'Test Enhanced Analysis';
                result.style.display = 'block';
            }
        }

        async function testSampleDocument() {
            const btn = document.getElementById('btn3');
            const result = document.getElementById('result3');

            btn.disabled = true;
            btn.textContent = 'Testing...';
            result.style.display = 'none';

            try {
                const testDoc = {
                    text: `MEETING MINUTES
Board of Trustees Meeting
Date: January 15, 2024
Time: 2:00 PM
Location: Conference Room A

Attendees:
- John Smith, Chair
- Jane Doe, Vice Chair
- Bob Johnson, Secretary
- Mary Wilson, Trustee

Agenda Items:
1. Review of Q4 2023 financial statements
2. Discussion of new clinic program proposal
3. Budget approval for 2024

Motions:
- Motion to approve financial statements: PASSED 4-0
- Motion to approve budget: PASSED 3-1

Action Items:
- Follow up on clinic program details by February 1
- Schedule next meeting for February 15, 2024`,
                    filename: 'test-meeting-minutes-2024.pdf'
                };

                const response = await fetch(`${API_BASE}/api/test/enhanced-extractor`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testDoc)
                });

                if (response.ok) {
                    const data = await response.json();
                    result.innerHTML = `‚úÖ Sample Document Test Results:

üìã Document: Meeting Minutes
üéØ Enhanced Classification: ${data.enhanced_features.document_type}
üìä Confidence: ${Math.round(data.enhanced_features.confidence * 100)}%

üîç Enhanced Features Demonstrated:
   ‚Ä¢ Document Type Recognition: ${data.enhanced_features.document_type}
   ‚Ä¢ Evidence Count: ${data.enhanced_features.evidence_count}
   ‚Ä¢ Available Sections: ${data.enhanced_features.sections_available.join(', ')}

üìù This demonstrates how the enhanced extractor can:
   ‚Ä¢ Recognize meeting minutes vs generic documents
   ‚Ä¢ Extract structured information (attendees, motions, action items)
   ‚Ä¢ Provide evidence-based classification
   ‚Ä¢ Support the expanded document type coverage you requested`;
                    result.className = 'result success';
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                result.innerHTML = `‚ùå Test Failed: ${error.message}`;
                result.className = 'result error';
            } finally {
                btn.disabled = false;
                btn.textContent = 'Test Sample Document';
                result.style.display = 'block';
            }
        }
    </script>
</body>

</html>
